= Infrastructure

== Create keypair
```
ssh-keygen -f ./mykey.pem
```


== Interacting with Amazon Linux
Retrieve user and meta data, watch cloud init log
```
curl http://169.254.169.254/latest/user-data
curl http://169.254.169.254/latest/meta-data/
curl http://169.254.169.254/latest/meta-data/iam/info

tail -f /var/log/cloud-init-output.log
```

Todo regular package updaes
```
yum update -y -q --security
```


## Param store

Export parameter value

[source,shell script]
----
AWS_REGION=eu-central-1 AWS_DEFAULT_REGION=eu-central-1 aws ssm get-parameter --with-decryption \
  --name "paramkeypath" --output text --query 'Parameter.Value')
----

## user
You can see all log's of your user data script and it will also create /etc/cloud folder.

/var/log/cloud-init.log and
/var/log/cloud-init-output.log


## Pricing

* [EC2](https://aws.amazon.com/ec2/instance-types/?nc1=h_ls) t3a.nano	2 vcpu,	0.5 GiB $0.0054 / hour  (for 1GB / t3a.micro $0.0108)  720h (1month) x 0,0054 = $3,888 = â‚¬3,50
* [Fargate](https://aws.amazon.com/de/fargate/pricing/) pro vCPU pro Stunde	0,04656 USD   76$ pro GB pro Stunde	0,00511 USD = 1,80

